# Route to get all time logs
@api.route('/time_logs', methods=['GET'])
def get_time_logs():
    logs = TimeLog.query.all()
    return jsonify([log.serialize() for log in logs]), 200

# Route to create a new time log
@api.route('/time_logs', methods=['POST'])
def create_time_log():
    data = request.get_json()

    if not data or not all(key in data for key in ('employee_id', 'clock_in_time')):
        return jsonify({"error": "Missing required fields"}), 400

    try:
        new_log = TimeLog(
            employee_id=data['employee_id'],
            clock_in_time=data['clock_in_time'],
            clock_out_time=data.get('clock_out_time', None),
            status=data.get('status', 'clocked_in')
        )
        db.session.add(new_log)
        db.session.commit()
        return jsonify(new_log.serialize()), 201
    except Exception as e:
        db.session.rollback()
        return jsonify({"error": str(e)}), 500