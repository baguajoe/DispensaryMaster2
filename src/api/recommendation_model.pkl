import pandas as pd
from surprise import SVD, Dataset, Reader
import joblib

# Sample data for training
data = pd.DataFrame({
    "customer_id": [1, 1, 2, 2, 3],
    "product_id": [101, 102, 101, 103, 102],
    "rating": [5, 4, 5, 3, 4]  # Implicit feedback or purchase frequency
})

# Prepare data for Surprise
reader = Reader(rating_scale=(1, 5))
dataset = Dataset.load_from_df(data[["customer_id", "product_id", "rating"]], reader)
trainset = dataset.build_full_trainset()

# Train the model using Singular Value Decomposition (SVD)
model = SVD()
model.fit(trainset)

# Save the trained model
joblib.dump(model, "backend/models/recommendation_model.pkl")
print("Model saved as recommendation_model.pkl")
